{"version":3,"file":"vue.js","sources":["../src/compiler/parse.js","../src/compiler/index.js","../src/observe/dep.js","../src/observe/watcher.js","../src/vdom.js","../src/lifecycle.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/shared/index.js","../src/utils/index.js","../src/init.js","../src/index.js"],"sourcesContent":["const attribute =\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\nconst dynamicArgAttribute =\n  /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配开始标签 [1] 为标签的名字\nconst startTagClose = /^\\s*(\\/?)>/;\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);\nconst doctype = /^<!DOCTYPE [^>]+>/i;\n// #7298: escape - to avoid being passed as HTML comment when inlined in page\nconst comment = /^<!\\--/;\nconst conditionalComment = /^<!\\[/;\n\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{ aaa }} 匹配到表达式变量\n\n/**\n * 匹配到一个删除一个，直到没有\n * 参考：https://www.npmjs.com/package/htmlparser2\n * @param {*} html\n * @return {*}\n */\nexport function parseHTML(html) {\n  const ELEMENT_TYPE = 3;\n  const TEXT_TYPE = 1;\n  const stack = []; // 用于存放元素，从而构建抽象语法树 （栈的最后一个元素就是下一个元素的父元素）\n  let currentParent; // 指向栈的最后一个\n  let root;\n\n  function createASTElement(tag, attrs) {\n    return {\n      tag,\n      type: ELEMENT_TYPE,\n      children: [],\n      attrs,\n      parent: null,\n    };\n  }\n\n  // 前进，删除匹配过的数据\n  function advance(n) {\n    html = html.substring(n);\n  }\n\n  function parseStartTag() {\n    const start = html.match(startTagOpen);\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: [],\n      };\n      advance(start[0].length);\n      // console.log(`[index] start match`, match, html);\n      // 如果不是结束标签就一直匹配下去\n      let attr = html.match(attribute);\n      let end = html.match(startTagClose);\n\n      while (!end && attr) {\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5] || true,\n        });\n        advance(attr[0].length);\n        end = html.match(startTagClose);\n        attr = html.match(attribute);\n      }\n      // 删除结束标签\n      if (end) {\n        advance(end[0].length);\n      }\n      return match;\n    }\n    return false;\n  }\n\n  function handleStart(tag, attrs) {\n    const node = createASTElement(tag, attrs);\n    // 检查树的根节点\n    if (!root) {\n      root = node;\n    }\n    if (currentParent) {\n      node.parent = currentParent;\n      currentParent.children.push(node);\n    }\n\n    stack.push(node);\n    currentParent = node;\n  }\n\n  // 文本节点直接放到当前指向的节点\n  function handleText(content) {\n    const text = content.replace(/\\s/g, \"\");\n    if (!text) return;\n    const node = {\n      text,\n      type: TEXT_TYPE,\n      parent: currentParent,\n    };\n    currentParent.children.push(node);\n  }\n\n  function handleEnd(tag) {\n    const node = stack.pop();\n    if (node.tag !== tag) {\n      throw Error(\"tag 不匹配 \");\n    }\n    currentParent = stack[stack.length - 1];\n  }\n\n  // html 的开始肯定是 < 符号\n  while (html) {\n    /**\n     * <div>111</div>\n     * 如果值为 0：标签的开始\n     * 不为0: 文本的结束位置 （111）\n     */\n    let textEnd = html.indexOf(\"<\");\n    if (textEnd === 0) {\n      const startTagMatch = parseStartTag();\n      if (startTagMatch) {\n        handleStart(startTagMatch.tagName, startTagMatch.attrs);\n        continue;\n      }\n\n      const endTagMatch = html.match(endTag);\n\n      if (endTagMatch) {\n        handleEnd(endTagMatch[1]);\n        advance(endTagMatch[0].length);\n        continue;\n      }\n      // break;\n    }\n\n    if (textEnd > 0) {\n      const text = html.substring(0, textEnd);\n      if (text) {\n        handleText(text);\n        advance(text.length);\n      }\n    }\n  }\n  return root;\n}\n","import { parseHTML } from \"./parse\";\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // {{ aaa }} 匹配到表达式变量\n\nfunction genProps(attrs) {\n  let str = \"\";\n  attrs.forEach(({ name, value }) => {\n    if (name === \"style\") {\n      const obj = {};\n      // color: \"red\"; top: 0; => 转换成 对象\n      value.split(\";\").forEach((item) => {\n        const [key, val] = item.split(\":\");\n        obj[key.trim()] = val.trim();\n      });\n      value = obj;\n    }\n\n    str += `${name}:${JSON.stringify(value)},`;\n  });\n  return `{${str.slice(0, -1)}}`;\n}\n\nfunction gen(node) {\n  if (node.type === 3) {\n    return genCode(node);\n  } else {\n    console.log(node);\n    let text = node.text;\n    if (!defaultTagRE.test(text)) {\n      return `_v(${JSON.stringify(text)})`;\n    } else {\n      // 匹配 {{name}} hello {{age}} world\n      // _v(_s(name) + \"hello\" + _s(age))\n      const tokens = [];\n      let match;\n      defaultTagRE.lastIndex = 0;\n      let lastIndex = 0;\n\n      while ((match = defaultTagRE.exec(text))) {\n        let index = match.index;\n        if (index > lastIndex) {\n          tokens.push(JSON.stringify(text.slice(lastIndex, index)));\n        }\n        tokens.push(`_s(${match[1].trim()})`);\n        lastIndex = index + match[0].length;\n      }\n      if (lastIndex < text.length) {\n        tokens.push(JSON.stringify(text.slice(lastIndex)));\n      }\n      console.log(`[index] tokens`, tokens);\n      return `_v(${tokens.join(\"+\")})`;\n    }\n  }\n}\n\nfunction genChildren(children) {\n  return children.map((child) => gen(child)).join(\",\");\n}\n\nfunction genCode(ast) {\n  const strProps = ast.attrs.length > 0 ? genProps(ast.attrs) : \"undefined\";\n  const strChild = ast.children.length ? \",\" + genChildren(ast.children) : \"\";\n  let code = `_c('${ast.tag}',${strProps}${strChild})`;\n\n  return code;\n}\n\nexport function compileToFunction(template) {\n  // 1. 将 template 转换成 ast\n  const ast = parseHTML(template);\n  console.log(\"ast:\", ast);\n  // 2. 生成 render 方法(render 的返回值就是 虚拟 DOM)\n  const code = genCode(ast);\n  // _v(_s(name) + \"hello\" + _s(age)) 里面的 name age 等变量是找不到的 需要通过 with，让其去 this(vm) 寻找\n  const render = new Function(`with(this){return ${code}}`);\n  // console.log(`[index] render`, render.toString());\n  return render;\n}\n","let id = 0;\n/**\n *\n */\nclass Dep {\n  constructor() {\n    this.id = id++;\n    // 存放 watcher\n    this.subs = [];\n  }\n\n  /**\n   * 依赖收集\n   * 不希望取到重复的 watcher，所以使用 addSub 方法来替代 this.subs.push\n   * addSub 是在 watcher 里调用、去重\n   */\n  depend() {\n    // this.subs.push(Dep.target);\n    Dep.target.addDep(this);\n  }\n\n  notify(){\n    this.subs.forEach(watcher => watcher.update())\n  }\n\n  addSub(watcher) {\n    this.subs.push(watcher);\n  }\n}\nDep.target = null;\n\nexport default Dep;\n","import Dep from \"./dep\";\n\nlet id = 0;\n\n/**\n * 不同组件会有不同的 watcher 实例，通过 id 区分\n * @return {*}\n */\nclass Watcher {\n  constructor(vm, cb) {\n    this.id = id++;\n    /**\n     * 收集依赖的属性（dep）计算属性、组件卸载等地方会用\n     */\n    this.deps = [];\n    this.depsIds = new Set();\n    this.getter = cb; // getter 意味着调用这个函数可以发生取值操作\n    this.get();\n  }\n\n  get() {\n    // Dep 的静态变量\n    Dep.target = this;\n    this.getter();\n    /**\n     * 为什么要赋值 null\n     * 在外部也会有取值的情况，同样会触发 get，赋值 null 可以保证仅在 watcher 里收集\n     */\n    Dep.target = null;\n  }\n\n  addDep(dep) {\n    const id = dep.id;\n    if (!this.depsIds.has(id)) {\n      this.deps.push(dep);\n      this.depsIds.add(id);\n      dep.addSub(this);\n    }\n  }\n\n  update() {\n    // console.log(`[watcher] update`);\n    // this.get();\n    queueWatcher(this);\n  }\n\n  run() {\n    console.log(`[watcher] run`);\n    this.get();\n  }\n}\n\nconst queue = [];\nlet hash = {};\nlet pending = false;\n\nfunction flushSchedulerQueue() {\n  queue.slice(0).forEach((w) => w.run());\n  queue.length = 0;\n  hash = {};\n  pending = false;\n}\n\nfunction queueWatcher(watcher) {\n  const id = watcher.id;\n  if (!hash[id]) {\n    queue.push(watcher);\n    hash[id] = true;\n    if (!pending) {\n      nextTick(flushSchedulerQueue);\n      pending = true;\n    }\n  }\n}\n\nlet callbacks = [];\nlet waiting = false;\n\nfunction flushCallbacks() {\n  waiting = false;\n  const cbs = callbacks.slice(0);\n  callbacks.length = 0;\n  cbs.forEach((cb) => cb());\n}\n\nexport function nextTick(cb) {\n  callbacks.push(cb);\n  if (!waiting) {\n    /**\n     * 内部没有用 setTimeout 而是采用降级处理（为了兼容低版本、IE）\n     * 微任务 > 宏任务\n     * promise > MutationObserver > setImmediate > setTimeout\n     */\n    setTimeout(flushCallbacks, 0);\n    waiting = true;\n  }\n}\n\nexport default Watcher;\n\n/**\n * 1. 创建 watcher 时 会把当前实例挂载在 Dep.target 上\n * 2. 调用 _render() 时，会取值，触发响应式的 get\n */\n","// _c()\nexport function createElementVNode(vm, tag, data = {}, ...children) {\n  const key = data.key;\n  if (key) {\n    delete data.key;\n  }\n  return vnode(vm, tag, key, data, children);\n}\n// _v()\nexport function createTextVNode(vm, text) {\n  return vnode(vm, undefined, undefined, undefined, undefined, text);\n}\n\nfunction vnode(vm, tag, key, data, children, text) {\n  return {\n    vm,\n    tag,\n    key,\n    data,\n    children,\n    text,\n  };\n}\n","import Watcher from \"./observe/watcher\";\nimport { createElementVNode, createTextVNode } from \"./vdom\";\n\n/**\n * 创建真实 dom\n * @param {*} vnode\n * @return {HTMLElement}\n */\nfunction createElement(vnode) {\n  const { tag, data, children, text } = vnode;\n  // 判断是标签\n  if (typeof tag === \"string\") {\n    vnode.el = document.createElement(tag);\n    patchProps(vnode.el, data);\n    children.forEach((child) => {\n      vnode.el.appendChild(createElement(child));\n    });\n  } else {\n    vnode.el = document.createTextNode(text);\n  }\n  return vnode.el;\n}\n\n/**\n * @description: 更新属性\n * @param {HTMLElement} el\n * @param {Object} props\n * @return {*}\n */\nfunction patchProps(el, props) {\n  for (let key in props) {\n    if (key === \"style\") {\n      for (let name in props.style) {\n        el.style[name] = props.style[name];\n      }\n    } else {\n      el.setAttribute(key, props[key]);\n    }\n  }\n}\n\nfunction patch(oldVNode, vnode) {\n  const isRealElement = oldVNode.nodeType;\n  if (isRealElement) {\n    /**\n     * @type {Node}\n     */\n    const el = oldVNode;\n    const parentEl = el.parentNode;\n    const newEl = createElement(vnode);\n    console.log(`[lifecycle] newEl`, newEl);\n    parentEl.insertBefore(newEl, el.nextSibling);\n    parentEl.removeChild(el);\n    return newEl;\n  } else {\n    // diff\n  }\n}\n\nexport function initLifeCycle(Vue) {\n  Vue.prototype._update = function (vnode) {\n    const vm = this;\n    console.log(`[lifecycle] update`, vnode, vm);\n    // 初始化/更新 真实 dom\n    vm.$el = patch(vm.$el, vnode);\n  };\n\n  // _c('div', {}, ...children)\n  Vue.prototype._c = function () {\n    return createElementVNode(this, ...arguments);\n  };\n\n  // _v(text)\n  Vue.prototype._v = function () {\n    return createTextVNode(this, ...arguments);\n  };\n\n  Vue.prototype._s = function (val) {\n    if (typeof val !== \"object\") return val;\n    return JSON.stringify(val);\n  };\n\n  /**\n   * 创建虚拟 dom\n   * @return {*} 返回虚拟 dom\n   */\n  Vue.prototype._render = function () {\n    console.log(`[lifecycle] render`);\n    const vm = this;\n    /**\n     * ast 生成的 render\n     * 渲染时会去 vm 上取值，以达成数据和视图绑定到一起\n     */\n    return vm.$options.render.call(vm);\n  };\n}\n\nexport function mountComponent(vm, el) {\n  // 1. render 函数生成虚拟dom\n  // 2. 根据虚拟 dom 生成真实 dom\n  // 3. 插入到 el\n  vm.$el = el;\n  const updateComponent = () => {\n    vm._update(vm._render());\n  };\n  new Watcher(vm, updateComponent)\n}\n\n// vue 流程\n\n/**\n * 1. 创建响应式数据\n * 2. 模版转换成 ast\n * 3. ast 转换成 render 函数\n * 4. 每次数据更新 直接调用 render 函数，无需再次执行 ast 转换\n */\n\nexport function callHooks(vm, hook) {\n  const handlers = vm.$options[hook];\n  if (handlers) {\n    handlers.forEach((h) => h.call(vm));\n  }\n}\n","// 重写数组中的部分方法\n\nlet oldArrayProto = Array.prototype;\n\nlet newArrayProto = Object.create(oldArrayProto);\n\nconst methods = [\n  \"push\",\n  \"pop\",\n  \"shift\",\n  \"unshift\",\n  \"reverse\",\n  \"sort\",\n  \"splice\",\n];\n\nmethods.forEach((method) => {\n  newArrayProto[method] = function (...args) {\n    const result = oldArrayProto[method].apply(this, args);\n\n    const ob = this.__ob__;\n    // 劫持数组新增的内容\n    let inserted;\n    switch (method) {\n      case \"push\":\n      case \"unshift\":\n        inserted = args;\n        break;\n      case \"splice\":\n        inserted = args.slice(2);\n      default:\n        break;\n    }\n\n    if (inserted) {\n      ob.observeArray(inserted);\n    }\n\n    console.log(`[array] 劫持了数组的方法`);\n    ob.dep.notify();\n    return result;\n  };\n});\n\nexport { newArrayProto };\n","import { newArrayProto } from \"./array\";\nimport Dep from \"./dep\";\n\nclass Observer {\n  constructor(data) {\n    // Object.defineProperty 只能劫持存在的属性，新增的 删除的检测不到\n\n    this.dep = new Dep();\n\n    // 将当前对象的实例挂载到 data 上，为了 在 array.js 文件中重写方法时 能调用到 ob 的方法\n    // data.__ob__ = this; 不能这样写，因为在遍历对象的时候会死循环\n    Object.defineProperty(data, \"__ob__\", {\n      value: this,\n      enumerable: false,\n    });\n\n    // 数组很少用下标的方式来修改，而这样遍历劫持又回很浪费性能，所以不对数组下标劫持\n    if (Array.isArray(data)) {\n      /**\n       * 一般对数组操作用 push、shift、等 7个方法。\n       * 我们可以重写这些方法，保留其他方法\n       */\n      data.__proto__ = newArrayProto;\n\n      this.observeArray(data); // 数组中的对象也要被监测\n    } else {\n      this.walk(data);\n    }\n  }\n\n  walk(data) {\n    // ”重新定义“ 属性 vue2 的性能瓶颈\n    Object.keys(data).forEach((key) => defineReactive(data, key, data[key]));\n  }\n\n  observeArray(arr) {\n    arr.forEach((item) => observe(item));\n  }\n}\n/**\n * 属性劫持\n * @param {*} target\n * @param {*} key\n * @param {*} val\n */\nexport function defineReactive(target, key, val) {\n  // 递归深度劫持\n  const ob = observe(val);\n  const dep = new Dep();\n  // 闭包 会将 val 存在 defineReactive 这个作用域里\n  Object.defineProperty(target, key, {\n    get() {\n      if (Dep.target) {\n        // 对象里的属性进行依赖收集\n        dep.depend();\n        // 对象、数组本身进行依赖收集\n        if (ob) {\n          ob.dep.depend();\n          if (Array.isArray(val)) {\n            // TODO: [1,2,[1,4]] 这种数组套数组的情况还是不会依赖收集，所以需要递归添加\n          }\n        }\n      }\n      return val;\n    },\n    set(newVal) {\n      if (newVal === val) return;\n      // 当重新赋值时，新值也要进行劫持\n      observe(newVal);\n      val = newVal;\n      dep.notify();\n    },\n  });\n}\n\nexport function observe(data) {\n  // 仅仅对对象进行劫持\n  if (data === null || typeof data !== \"object\") {\n    return;\n  }\n\n  // 被监测过的不在监听\n  if (data.__ob__ instanceof Observer) {\n    return data.__ob__;\n  }\n\n  return new Observer(data);\n}\n","import { observe } from \"./observe/index\";\n\nfunction initState(vm) {\n  const opts = vm.$options;\n  if (opts.data) {\n    initData(vm);\n  }\n}\n\n// 代理取值 vm.name => vm._data.name\nfunction proxy(vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[target][key];\n    },\n    set(nv) {\n      vm[target][key] = nv;\n    },\n  });\n}\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n\n  // vue 根实例的 data 可以是对象、函数。 组件里的 data 必须是函数\n  data = typeof data === \"function\" ? data.call(vm) : data;\n\n  vm._data = data;\n\n  // 数据劫持 defineProperty\n  observe(data);\n\n  for (const key in data) {\n    proxy(vm, \"_data\", key);\n  }\n}\n\nexport { initState };\n","export const LIFECYCLE_HOOKS = [\n  \"beforeCreate\",\n  \"created\",\n  \"beforeMount\",\n  \"mounted\",\n  \"beforeUpdate\",\n  \"updated\",\n  \"beforeDestroy\",\n  \"destroyed\",\n  \"activated\",\n  \"deactivated\",\n  \"errorCaptured\",\n  \"serverPrefetch\",\n];\n","import { LIFECYCLE_HOOKS } from \"../shared/index\";\n/**\n * 合并 options\n * TODO\n */\nexport function mergeOptions(parent, child) {\n  const opts = {};\n  function mergeField(k) {\n    // 为了实现 mixin，将生命周期钩子转换成数组\n    if (LIFECYCLE_HOOKS.includes(k)) {\n      opts[k] = [child[k] || parent[k]];\n    } else {\n      opts[k] = child[k] || parent[k];\n    }\n  }\n\n  for (let key in parent) {\n    mergeField(key);\n  }\n  for (let key in child) {\n    mergeField(key);\n  }\n  return opts;\n}\n","import { compileToFunction } from \"./compiler/index\";\nimport { callHooks, mountComponent } from \"./lifecycle\";\nimport { initState } from \"./state\";\nimport { mergeOptions } from \"./utils/index\";\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    // $ 开头的都认为是自己的属性，data 里设置 $name $age 会不生效\n    const vm = this;\n    // 将配置挂载到实例上 方便其他方法访问\n    vm.$options = mergeOptions(options, {});\n\n    callHooks(vm, \"beforeCreate\");\n    initState(vm);\n    callHooks(vm, \"created\");\n\n    if (options.el) {\n      vm.$mount(options.el);\n    }\n  };\n\n  Vue.prototype.$mount = function (el) {\n    const vm = this;\n    const opts = vm.$options;\n    el = document.querySelector(el);\n\n    if (!opts.render) {\n      let template;\n      if (opts.template) {\n        template = opts.template;\n      } else {\n        template = el.outerHTML;\n      }\n      console.log(\"template1: \", template);\n      if (template) {\n        opts.render = compileToFunction(template);\n      }\n    }\n    console.log(opts.render);\n    mountComponent(vm, el);\n  };\n}\n","import { initMixin } from \"./init\";\nimport { initLifeCycle } from \"./lifecycle\";\nimport { nextTick } from \"./observe/watcher\";\n\nfunction Vue(options) {\n  this._init(options);\n}\n\ninitMixin(Vue);\ninitLifeCycle(Vue);\n\nVue.prototype.$nextTick = nextTick;\n\nexport default Vue;\n"],"names":["attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","parent","advance","n","substring","parseStartTag","start","match","tagName","length","attr","end","push","name","value","handleStart","node","handleText","content","text","replace","handleEnd","pop","Error","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","str","forEach","obj","split","item","key","val","trim","JSON","stringify","slice","gen","genCode","console","log","test","tokens","lastIndex","exec","index","join","genChildren","map","child","ast","strProps","strChild","code","compileToFunction","template","render","Function","id","Dep","subs","target","addDep","watcher","update","Watcher","vm","cb","deps","depsIds","Set","getter","get","dep","has","add","addSub","queueWatcher","queue","hash","pending","flushSchedulerQueue","w","run","nextTick","callbacks","waiting","flushCallbacks","cbs","setTimeout","createElementVNode","data","vnode","createTextVNode","undefined","createElement","el","document","patchProps","appendChild","createTextNode","props","style","setAttribute","patch","oldVNode","isRealElement","nodeType","parentEl","parentNode","newEl","insertBefore","nextSibling","removeChild","initLifeCycle","Vue","prototype","_update","$el","_c","arguments","_v","_s","_render","$options","call","mountComponent","updateComponent","callHooks","hook","handlers","h","oldArrayProto","Array","newArrayProto","Object","create","methods","method","args","result","apply","ob","__ob__","inserted","observeArray","notify","Observer","defineProperty","enumerable","isArray","__proto__","walk","keys","defineReactive","arr","observe","depend","set","newVal","initState","opts","initData","proxy","nv","_data","LIFECYCLE_HOOKS","mergeOptions","mergeField","k","includes","initMixin","_init","options","$mount","querySelector","outerHTML","$nextTick"],"mappings":"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"}